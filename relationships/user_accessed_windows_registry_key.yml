name: User accessed Windows registry key
contributors:
  - Reid Gilman @reidgilman
attack:
behavior:
  source: user 
  relationship: accessed
  target: windows registry key
security_events:
  - event_id: 4663
    name: An attempt was made to access an object.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Registry
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 12
    name: RegistryEvent (Object create and delete)
    platform: Windows
    audit_category: RegistryEvent
    audit_sub_category: Object create and delete
    log_channel: Sysmon
    log_provider: Microsoft-Windows-Sysmon/Operational
  - event_id: 13
    name: RegistryEvent (Value Set)
    platform: Windows
    audit_category: RegistryEvent
    audit_sub_category: Value Set
    log_channel: Sysmon
    log_provider: Microsoft-Windows-Sysmon/Operational
  - event_id: 14
    name: RegistryEvent (Key and Value Rename)
    platform: Windows
    audit_category: RegistryEvent
    audit_sub_category: Key and Value Rename
    log_channel: Sysmon
    log_provider: Microsoft-Windows-Sysmon/Operational
references:
notes:
  - Sysmon events will not show access when it is only used to read a registry key. Event 4663 will report on the
    handle opening but does not confirm that it was ever used
