# ATT&CK DS Event Mappings

|Data Source|Component|Source|Relationship|Target|EventID|Log Provider|Log Channel|Audit Category|Audit Sub-Category|Enable Commands| GPO Audit Policy|
| :---| :---| :---| :---| :---| :---| :---| :---| :---| :---| :---| :---|
|Authentication log|authentication success|user|authenticated|host|4624|Microsoft-Windows-Security-Auditing|Security|Logon/Logoff|Logon| `auditpol /set /subcategory:"Logon" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Logon/Logoff -> Audit Logon |
|Authentication log|authentication success|user|authenticated|host|4778|Microsoft-Windows-Security-Auditing|Security|Logon/Logoff|Other Logon/Logoff Events| `auditpol /set /subcategory:"Other Logon/Logoff Events" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Logon/Logoff -> Audit Other Logon/Logoff Events |
|File|file creation|process|created|file|11|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|FileCreate|NA| `<FileCreate onmatch="exclude" />` |NA|
|File|file deletion|process|deleted|file|23|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|FileDelete|NA| `<FileDelete onmatch="exclude" />` |NA|
|File|file share access|user|accessed|file share|5140|Microsoft-Windows-Security-Auditing|Security|Object Access|File Share| `auditpol /set /subcategory:"File Share" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit File Share |
|File|file access|user|accessed|file|5145|Microsoft-Windows-Security-Auditing|Security|Object Access|Detailed File Share| `auditpol /set /subcategory:"Detailed File Share" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit Detailed File Share |
|File|file access|user|accessed|file|4663|Microsoft-Windows-Security-Auditing|Security|Object Access|File System| `auditpol /set /subcategory:"File System" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit File System |
|File|file access|process|accessed|file|4663|Microsoft-Windows-Security-Auditing|Security|Object Access|File System| `auditpol /set /subcategory:"File System" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit File System |
|File|file access|user|requested access|file|4656|Microsoft-Windows-Security-Auditing|Security|Object Access|File System| `auditpol /set /subcategory:"File System" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit File System |
|File|file access|user|requested access|file|4661|Microsoft-Windows-Security-Auditing|Security|DS Access|Directory Service Access| `auditpol /set /subcategory:"Directory Service Access" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> DS Access -> Audit Directory Service Access |
|File|file access|user|requested access|file|4661|Microsoft-Windows-Security-Auditing|Security|Object Access|SAM| `auditpol /set /subcategory:"SAM" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit SAM |
|File|file access|user|requested access|file|4692|Microsoft-Windows-Security-Auditing|Security|Detailed Tracking|DPAPI Activity| `auditpol /set /subcategory:"DPAPI Activity" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Detailed Tracking -> Audit DPAPI Activity |
|File|file access|process|requested access|file|4656|Microsoft-Windows-Security-Auditing|Security|Object Access|File System| `auditpol /set /subcategory:"File System" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit File System |
|File|file access|process|requested access|file|4661|Microsoft-Windows-Security-Auditing|Security|DS Access|Directory Service Access| `auditpol /set /subcategory:"Directory Service Access" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> DS Access -> Audit Directory Service Access |
|File|file access|process|requested access|file|4661|Microsoft-Windows-Security-Auditing|Security|Object Access|SAM| `auditpol /set /subcategory:"SAM" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit SAM |
|Module|module load|process|loaded|dll|7|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|ImageLoad|NA| `<ImageLoad onmatch="exclude" />` |NA|
|Module|module load|process|loaded|executable|7|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|ImageLoad|NA| `<ImageLoad onmatch="exclude" />` |NA|
|Named pipe|named pipe creation|process|created|pipe|17|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|PipeEvent|NA| `<PipeEvent onmatch="exclude" />` |NA|
|Powershell log|powershell context|application host|started|None|400|PowerShell|Windows PowerShell|NA|NA|NA|NA|
|Powershell log|powershell context|application domain|started|None|53504|Microsoft-Windows-PowerShell|Microsoft-Windows-PowerShell/Operational|NA|NA|NA|NA|
|Powershell log|powershell execution|user|started|application host|4103|Microsoft-Windows-PowerShell|Microsoft-Windows-PowerShell/Operational|NA|NA|NA|NA|
|Powershell log|powershell execution|process|executed|command|4103|Microsoft-Windows-PowerShell|Microsoft-Windows-PowerShell/Operational|NA|NA|NA|NA|
|Powershell log|powershell execution|process|executed|command|4104|Microsoft-Windows-PowerShell|Microsoft-Windows-PowerShell/Operational|NA|NA|NA|NA|
|Process|process creation|user|created|process|4688|Microsoft-Windows-Security-Auditing|Security|Detailed Tracking|Process Creation| `auditpol /set /subcategory:"Process Creation" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Detailed Tracking -> Audit Process Creation |
|Process|process creation|user|created|process|1|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|ProcessCreate|NA| `<ProcessCreate onmatch="exclude" />` |NA|
|Process|process creation|process|created|process|4688|Microsoft-Windows-Security-Auditing|Security|Detailed Tracking|Process Creation| `auditpol /set /subcategory:"Process Creation" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Detailed Tracking -> Audit Process Creation |
|Process|process creation|process|created|process|1|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|ProcessCreate|NA| `<ProcessCreate onmatch="exclude" />` |NA|
|Process|process access|process|accessed|process|4663|Microsoft-Windows-Security-Auditing|Security|Object Access|Kernel Object| `auditpol /set /subcategory:"Kernel Object" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit Kernel Object |
|Process|process access|process|accessed|process|10|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|ProcessAccess|NA| `<ProcessAccess onmatch="exclude" />` |NA|
|Process|process access|process|accessed|process|8|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|CreateRemoteThread|NA| `<CreateRemoteThread onmatch="exclude" />` |NA|
|Process|process access|process|requested access|process|4656|Microsoft-Windows-Security-Auditing|Security|Object Access|Kernel Object| `auditpol /set /subcategory:"Kernel Object" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit Kernel Object |
|Process|process network connection|process|connected to|port|5156|Microsoft-Windows-Security-Auditing|Security|Object Access|Filtering Platform Connection| `auditpol /set /subcategory:"Filtering Platform Connection" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit Filtering Platform Connection |
|Process|process network connection|process|connected to|port|3|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NetworkConnect|NA| `<NetworkConnect onmatch="exclude" />` |NA|
|Process|process network connection|process|connected to|ip|5156|Microsoft-Windows-Security-Auditing|Security|Object Access|Filtering Platform Connection| `auditpol /set /subcategory:"Filtering Platform Connection" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit Filtering Platform Connection |
|Process|process network connection|process|connected to|ip|3|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NetworkConnect|NA| `<NetworkConnect onmatch="exclude" />` |NA|
|Process|process network connection|process|connected to|host|3|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NetworkConnect|NA| `<NetworkConnect onmatch="exclude" />` |NA|
|Process|process network connection|process|connected from|port|5156|Microsoft-Windows-Security-Auditing|Security|Object Access|Filtering Platform Connection| `auditpol /set /subcategory:"Filtering Platform Connection" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit Filtering Platform Connection |
|Process|process network connection|process|connected from|port|3|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NetworkConnect|NA| `<NetworkConnect onmatch="exclude" />` |NA|
|Process|process network connection|process|connected from|ip|5156|Microsoft-Windows-Security-Auditing|Security|Object Access|Filtering Platform Connection| `auditpol /set /subcategory:"Filtering Platform Connection" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit Filtering Platform Connection |
|Process|process network connection|process|connected from|ip|3|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NetworkConnect|NA| `<NetworkConnect onmatch="exclude" />` |NA|
|Process|process network connection|process|connected from|host|3|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NetworkConnect|NA| `<NetworkConnect onmatch="exclude" />` |NA|
|Process|process network connection|user|connected to|port|3|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NetworkConnect|NA| `<NetworkConnect onmatch="exclude" />` |NA|
|Process|process network connection|user|connected to|ip|3|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NetworkConnect|NA| `<NetworkConnect onmatch="exclude" />` |NA|
|Process|process network connection|user|connected to|host|3|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NetworkConnect|NA| `<NetworkConnect onmatch="exclude" />` |NA|
|Process|process network connection|user|connected from|port|3|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NetworkConnect|NA| `<NetworkConnect onmatch="exclude" />` |NA|
|Process|process network connection|user|connected from|ip|3|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NetworkConnect|NA| `<NetworkConnect onmatch="exclude" />` |NA|
|Process|process network connection|user|connected from|host|3|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NetworkConnect|NA| `<NetworkConnect onmatch="exclude" />` |NA|
|Service|service creation|user|created|service|4697|Microsoft-Windows-Security-Auditing|Security|System|Security System Extension| `auditpol /set /subcategory:"Security System Extension" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> System -> Audit Security System Extension |
|Service|service creation|user|created|service|7045|Service Control Manager|System|NA|NA|NA|NA|
|User Account|user account creation|user|created|user|4720|Microsoft-Windows-Security-Auditing|Security|Account Management|User Account Management| `auditpol /set /subcategory:"User Account Management" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Account Management -> Audit User Account Management |
|Windows active directory|active directory service access|user|accessed|ad object|4662|Microsoft-Windows-Security-Auditing|Security|DS Access|Directory Service Access| `auditpol /set /subcategory:"Directory Service Access" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> DS Access -> Audit Directory Service Access |
|Windows active directory|active directory service access|user|requested access|ad object|4661|Microsoft-Windows-Security-Auditing|Security|DS Access|Directory Service Access| `auditpol /set /subcategory:"Directory Service Access" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> DS Access -> Audit Directory Service Access |
|Windows active directory|active directory service access|process|requested access|ad object|4661|Microsoft-Windows-Security-Auditing|Security|DS Access|Directory Service Access| `auditpol /set /subcategory:"Directory Service Access" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> DS Access -> Audit Directory Service Access |
|Windows active directory|active directory service modification|user|modified|ad object|5136|Microsoft-Windows-Security-Auditing|Security|DS Access|Directory Service Changes| `auditpol /set /subcategory:"Directory Service Changes" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> DS Access -> Audit Directory Service Changes |
|Windows registry|windows registry key creation|process|created|windows registry key|12|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|RegistryEvent|NA| `<RegistryEvent onmatch="exclude" />` |NA|
|Windows registry|windows registry key creation|process|created|windows registry key value|12|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|RegistryEvent|NA| `<RegistryEvent onmatch="exclude" />` |NA|
|Windows registry|windows registry key deletion|process|deleted|windows registry key|12|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|RegistryEvent|NA| `<RegistryEvent onmatch="exclude" />` |NA|
|Windows registry|windows registry key deletion|process|deleted|windows registry key value|12|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|RegistryEvent|NA| `<RegistryEvent onmatch="exclude" />` |NA|
|Windows registry|windows registry key modification|process|modified|windows registry key|13|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|RegistryEvent|NA| `<RegistryEvent onmatch="exclude" />` |NA|
|Windows registry|windows registry key modification|process|modified|windows registry key|14|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|RegistryEvent|NA| `<RegistryEvent onmatch="exclude" />` |NA|
|Windows registry|windows registry key modification|process|modified|windows registry key value|13|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|RegistryEvent|NA| `<RegistryEvent onmatch="exclude" />` |NA|
|Windows registry|windows registry key modification|process|modified|windows registry key value|14|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|RegistryEvent|NA| `<RegistryEvent onmatch="exclude" />` |NA|
|Windows registry|windows registry key modification|process|modified|windows registry key value|4657|Microsoft-Windows-Security-Auditing|Security|Object Access|Registry| `auditpol /set /subcategory:"Registry" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit Registry |
|Windows registry|windows registry key modification|user|modified|windows registry key value|4657|Microsoft-Windows-Security-Auditing|Security|Object Access|Registry| `auditpol /set /subcategory:"Registry" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit Registry |
|Windows registry|Windows registry key access|process|accessed|windows registry key|4663|Microsoft-Windows-Security-Auditing|Security|Object Access|Registry| `auditpol /set /subcategory:"Registry" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit Registry |
|Windows registry|Windows registry key access|user|accessed|windows registry key|4663|Microsoft-Windows-Security-Auditing|Security|Object Access|Registry| `auditpol /set /subcategory:"Registry" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit Registry |
|Windows registry|Windows registry key access|process|requested access|windows registry key|4656|Microsoft-Windows-Security-Auditing|Security|Object Access|Registry| `auditpol /set /subcategory:"Registry" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit Registry |
|Windows registry|Windows registry key access|user|requested access|windows registry key|4656|Microsoft-Windows-Security-Auditing|Security|Object Access|Registry| `auditpol /set /subcategory:"Registry" /success:enable /failure:enable` | Computer Configuration -> Windows Settings -> Security Settings -> Advanced Audit Policy Configuration -> System Audit Policies -> Object Access -> Audit Registry |
|WMI object|wmi object context|wmi subscription|created|None|5861|Microsoft-Windows-WMI-Activity|Microsoft-Windows-WMI-Activity/Operational|NA|NA|NA|NA|
|WMI object|wmi object creation|user|created|wmi filter|19|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NA|NA| `< onmatch="exclude" />` |NA|
|WMI object|wmi object creation|user|created|wmi consumer|20|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NA|NA| `< onmatch="exclude" />` |NA|
|WMI object|wmi object creation|user|created|wmi subscription|21|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NA|NA| `< onmatch="exclude" />` |NA|
|WMI object|wmi object deletion|user|deleted|wmi filter|19|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NA|NA| `< onmatch="exclude" />` |NA|
|WMI object|wmi object deletion|user|deleted|wmi consumer|20|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NA|NA| `< onmatch="exclude" />` |NA|
|WMI object|wmi object deletion|user|deleted|wmi subscription|21|Microsoft-Windows-Sysmon|Microsoft-Windows-Sysmon/Operational|NA|NA| `< onmatch="exclude" />` |NA|
