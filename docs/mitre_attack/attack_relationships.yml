- name: Host blocked connection from Ip
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: host
    relationship: blocked connection from
    target: ip
  security_events:
  - event_id: 5157
    name: The Windows Filtering Platform has blocked a connection.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Host blocked connection from Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: host
    relationship: blocked connection from
    target: port
  security_events:
  - event_id: 5157
    name: The Windows Filtering Platform has blocked a connection.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Host blocked connection from Process
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: host
    relationship: blocked connection from
    target: process
  security_events:
  - event_id: 5157
    name: The Windows Filtering Platform has blocked a connection.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Host blocked connection to Ip
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: host
    relationship: blocked connection to
    target: ip
  security_events:
  - event_id: 5157
    name: The Windows Filtering Platform has blocked a connection.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Host blocked connection to Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: host
    relationship: blocked connection to
    target: port
  security_events:
  - event_id: 5157
    name: The Windows Filtering Platform has blocked a connection.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Host blocked connection to Process
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: host
    relationship: blocked connection to
    target: process
  security_events:
  - event_id: 5157
    name: The Windows Filtering Platform has blocked a connection.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 5031
    name: The Windows Firewall Service blocked an application from accepting incoming
      connections on the network.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Host blocked listener on Ip
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: host
    relationship: blocked listener on
    target: ip
  security_events:
  - event_id: 5155
    name: The Windows Filtering Platform has blocked an application or service from
      listening on a port for incoming connections.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Host blocked listener on Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: host
    relationship: blocked listener on
    target: port
  security_events:
  - event_id: 5155
    name: The Windows Filtering Platform has blocked an application or service from
      listening on a port for incoming connections.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Host blocked listener on Process
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: host
    relationship: blocked listener on
    target: process
  security_events:
  - event_id: 5155
    name: The Windows Filtering Platform has blocked an application or service from
      listening on a port for incoming connections.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Host blocked port bind on Ip
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: host
    relationship: blocked port bind on
    target: ip
  security_events:
  - event_id: 5159
    name: The Windows Filtering Platform has blocked a bind to a local port.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Host blocked port bind on Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: host
    relationship: blocked port bind on
    target: port
  security_events:
  - event_id: 5159
    name: The Windows Filtering Platform has blocked a bind to a local port.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Host blocked port bind on Process
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: host
    relationship: blocked port bind on
    target: process
  security_events:
  - event_id: 5159
    name: The Windows Filtering Platform has blocked a bind to a local port.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Host permitted listener on Ip
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: host
    relationship: permitted listener on
    target: ip
  security_events:
  - event_id: 5154
    name: The Windows Filtering Platform has permitted an application or service to
      listen on a port for incoming connections.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Host permitted listener on Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: host
    relationship: permitted listener on
    target: port
  security_events:
  - event_id: 5154
    name: The Windows Filtering Platform has permitted an application or service to
      listen on a port for incoming connections.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Host permitted listener on Process
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: host
    relationship: permitted listener on
    target: process
  security_events:
  - event_id: 5154
    name: The Windows Filtering Platform has permitted an application or service to
      listen on a port for incoming connections.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Process accessed Process
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Process
    data_component: process access
  behavior:
    source: process
    relationship: accessed
    target: process
  security_events:
  - event_id: 10
    name: ProcessAccess.
    platform: Windows
    audit_category: ProcessAccess
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: Process attempted connection from Ip
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: process
    relationship: attempted connection from
    target: ip
  security_events:
  - event_id: 5157
    name: The Windows Filtering Platform has blocked a connection.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Process attempted connection from Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: process
    relationship: attempted connection from
    target: port
  security_events:
  - event_id: 5157
    name: The Windows Filtering Platform has blocked a connection.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Process attempted connection to Ip
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: process
    relationship: attempted connection to
    target: ip
  security_events:
  - event_id: 5157
    name: The Windows Filtering Platform has blocked a connection.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Process attempted connection to Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: process
    relationship: attempted connection to
    target: port
  security_events:
  - event_id: 5157
    name: The Windows Filtering Platform has blocked a connection.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Process attempted to bind on Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: process
    relationship: attempted to bind on
    target: port
  security_events:
  - event_id: 5159
    name: The Windows Filtering Platform has blocked a bind to a local port.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Process attempted to listen on Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: process
    relationship: attempted to listen on
    target: port
  security_events:
  - event_id: 5155
    name: The Windows Filtering Platform has blocked an application or service from
      listening on a port for incoming connections.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Process bound to Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: process
    relationship: bound to
    target: port
  security_events:
  - event_id: 5158
    name: The Windows Filtering Platform has permitted a bind to a local port.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Process connected from Host
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: process
    relationship: connected from
    target: host
  security_events:
  - event_id: 3
    name: Network connection.
    platform: Windows
    audit_category: NetworkConnect
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: Process connected from Ip
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: process
    relationship: connected from
    target: ip
  security_events:
  - event_id: 5156
    name: The Windows Filtering Platform has permitted a connection.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 3
    name: Network connection.
    platform: Windows
    audit_category: NetworkConnect
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: Process connected from Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: process
    relationship: connected from
    target: port
  security_events:
  - event_id: 5156
    name: The Windows Filtering Platform has permitted a connection.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 3
    name: Network connection.
    platform: Windows
    audit_category: NetworkConnect
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: Process connected to Host
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: process
    relationship: connected to
    target: host
  security_events:
  - event_id: 3
    name: Network connection.
    platform: Windows
    audit_category: NetworkConnect
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: Process connected to Ip
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: process
    relationship: connected to
    target: ip
  security_events:
  - event_id: 5156
    name: The Windows Filtering Platform has permitted a connection.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 3
    name: Network connection.
    platform: Windows
    audit_category: NetworkConnect
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: Process connected to Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: process
    relationship: connected to
    target: port
  security_events:
  - event_id: 5156
    name: The Windows Filtering Platform has permitted a connection.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 3
    name: Network connection.
    platform: Windows
    audit_category: NetworkConnect
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: Process created File
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: File
    data_component: file creation
  behavior:
    source: process
    relationship: created
    target: file
  security_events:
  - event_id: 11
    name: FileCreate.
    platform: Windows
    audit_category: FileCreate
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: DeviceFileEvents
    name: DeviceFileEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: Process created Process
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Process
    data_component: process creation
  behavior:
    source: process
    relationship: created
    target: process
  security_events:
  - event_id: 4688
    name: A new process has been created.
    platform: Windows
    audit_category: Detailed Tracking
    audit_sub_category: Process Creation
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 1
    name: Process Creation.
    platform: Windows
    audit_category: ProcessCreate
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: DeviceProcessEvents
    name: DeviceProcessEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: Process created Thread
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Process
    data_component: process creation
  behavior:
    source: process
    relationship: created
    target: thread
  security_events:
  - event_id: 8
    name: CreateRemoteThread.
    platform: Windows
    audit_category: CreateRemoteThread
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: Process created Windows registry key
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Windows Registry
    data_component: windows registry key creation
  behavior:
    source: process
    relationship: created
    target: windows registry key
  security_events:
  - event_id: 12
    name: RegistryEvent (Object create and delete).
    platform: Windows
    audit_category: RegistryEvent
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: DeviceRegistryEvents
    name: DeviceRegistryEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: Process created Windows registry key value
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Windows Registry
    data_component: windows registry key creation
  behavior:
    source: process
    relationship: created
    target: windows registry key value
  security_events:
  - event_id: 12
    name: RegistryEvent (Object create and delete).
    platform: Windows
    audit_category: RegistryEvent
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: DeviceRegistryEvents
    name: DeviceRegistryEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: Process deleted File
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: File
    data_component: file deletion
  behavior:
    source: process
    relationship: deleted
    target: file
  security_events:
  - event_id: 23
    name: File Delete archived.
    platform: Windows
    audit_category: FileDelete
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 26
    name: File Delete logged.
    platform: Windows
    audit_category: FileDeleteDetected
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 4660
    name: An object was deleted.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: File System
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Process deleted Windows registry key
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Windows Registry
    data_component: windows registry key deletion
  behavior:
    source: process
    relationship: deleted
    target: windows registry key
  security_events:
  - event_id: 12
    name: RegistryEvent (Object create and delete).
    platform: Windows
    audit_category: RegistryEvent
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 4660
    name: An object was deleted.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Registry
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Process deleted Windows registry key value
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Windows Registry
    data_component: windows registry key deletion
  behavior:
    source: process
    relationship: deleted
    target: windows registry key value
  security_events:
  - event_id: 12
    name: RegistryEvent (Object create and delete).
    platform: Windows
    audit_category: RegistryEvent
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: Process executed Command
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Command
    data_component: command execution
  behavior:
    source: process
    relationship: executed
    target: command
  security_events:
  - event_id: 4688
    name: A new process has been created.
    platform: Windows
    audit_category: Detailed Tracking
    audit_sub_category: Process Creation
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 1
    name: Process Creation.
    platform: Windows
    audit_category: ProcessCreate
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 4103
    name: Module logging.
    platform: Windows
    audit_category: Executing Pipeline
    log_channel: Microsoft-Windows-PowerShell/Operational
    log_provider: Microsoft-Windows-PowerShell
  - event_id: DeviceProcessEvents
    name: DeviceProcessEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: Process executed Script
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Script
    data_component: script execution
  behavior:
    source: process
    relationship: executed
    target: Script
  security_events:
  - event_id: 4103
    name: Module logging.
    platform: Windows
    audit_category: Executing Pipeline
    log_channel: Microsoft-Windows-PowerShell/Operational
    log_provider: Microsoft-Windows-PowerShell
  - event_id: 4104
    name: Script Block Logging.
    platform: Windows
    audit_category: Execute a Remote Command
    log_channel: Microsoft-Windows-PowerShell/Operational
    log_provider: Microsoft-Windows-PowerShell
  references: null
  notes: null
- name: Process listened on Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: process
    relationship: listened on
    target: port
  security_events:
  - event_id: 5154
    name: The Windows Filtering Platform has permitted an application or service to
      listen on a port for incoming connections.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Filtering Platform Connection
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Process loaded Module
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Module
    data_component: module load
  behavior:
    source: process
    relationship: loaded
    target: module
  security_events:
  - event_id: 7
    name: Image loaded.
    platform: Windows
    audit_category: ImageLoad
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: DeviceImageLoadEvents
    name: DeviceImageLoadEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: Process modified File
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: File
    data_component: file modification
  behavior:
    source: process
    relationship: modified
    target: file
  security_events:
  - event_id: 2
    name: A process changed a file creation time.
    platform: Windows
    audit_category: FileCreateTime
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 11
    name: FileCreate.
    platform: Windows
    audit_category: FileCreate
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 4670
    name: Permissions on an object were changed.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: File System
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: DeviceFileEvents
    name: DeviceFileEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: Process modified Windows registry key
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Windows Registry
    data_component: windows registry key modification
  behavior:
    source: process
    relationship: modified
    target: windows registry key
  security_events:
  - event_id: 13
    name: RegistryEvent (Value Set).
    platform: Windows
    audit_category: RegistryEvent
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 14
    name: RegistryEvent (Key and Value Rename).
    platform: Windows
    audit_category: RegistryEvent
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 4670
    name: Permissions on an object were changed.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Registry
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: DeviceRegistryEvents
    name: DeviceRegistryEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: Process modified Windows registry key value
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Windows Registry
    data_component: windows registry key modification
  behavior:
    source: process
    relationship: modified
    target: windows registry key value
  security_events:
  - event_id: 13
    name: RegistryEvent (Value Set).
    platform: Windows
    audit_category: RegistryEvent
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 14
    name: RegistryEvent (Key and Value Rename).
    platform: Windows
    audit_category: RegistryEvent
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 4657
    name: A registry value was modified.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Registry
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: DeviceRegistryEvents
    name: DeviceRegistryEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: Process requested access to File
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: File
    data_component: file access
  behavior:
    source: process
    relationship: requested access to
    target: file
  security_events:
  - event_id: 4656
    name: A handle to an object was requested.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: File System
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 4661
    name: A handle to an object was requested.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: SAM
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Process requested access to Process
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Process
    data_component: process access
  behavior:
    source: process
    relationship: requested access to
    target: process
  security_events:
  - event_id: 4656
    name: A handle to an object was requested.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Kernel Object
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Process requested access to Windows registry key
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Windows Registry
    data_component: windows registry key access
  behavior:
    source: process
    relationship: requested access to
    target: windows registry key
  security_events:
  - event_id: 4656
    name: A handle to an object was requested.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Registry
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: Service started
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Service
    data_component: service metadata
  behavior:
    source: service
    relationship: started
    target: null
  security_events:
  - event_id: 4
    name: Sysmon service state changed.
    platform: Windows
    audit_category: ServiceStateChange
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: Service stopped
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Service
    data_component: service metadata
  behavior:
    source: service
    relationship: stopped
    target: null
  security_events:
  - event_id: 4
    name: Sysmon service state changed.
    platform: Windows
    audit_category: ServiceStateChange
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: User added Firewall rule
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  attack:
    data_source: Firewall
    data_component: firewall rule modification
  behavior:
    source: user
    relationship: added
    target: firewall rule
  security_events:
  - event_id: 2004
    name: A rule has been added to the Windows Defender Firewall exception list
    platform: Windows
    audit_category: null
    audit_sub_category: null
    log_channel: Microsoft-Windows-Windows Firewall With Advanced Security/Firewall
    log_provider: Microsoft-Windows-Windows Firewall With Advanced Security
  - event_id: CreateRuleGroup
    name: CreateRuleGroup
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  references: null
  notes: null
- name: User attempted to authenticate from Ip
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: User Account
    data_component: user account authentication
  behavior:
    source: user
    relationship: attempted to authenticate from
    target: ip
  security_events:
  - event_id: 4625
    name: An account failed to log on.
    platform: Windows
    audit_category: Logon/Logoff
    audit_sub_category: Logon
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 4625
    name: An account failed to log on.
    platform: Windows
    audit_category: Logon/Logoff
    audit_sub_category: Account Lockout
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 4648
    name: A logon was attempted using explicit credentials.
    platform: Windows
    audit_category: Logon/Logoff
    audit_sub_category: Logon
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: ConsoleLogin
    name: ConsoleLogin
    platform: AWS
    audit_category: AwsConsoleSignin
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  references:
  - https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-non-api-events.html
  notes: null
- name: User attempted to authenticate from Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: User Account
    data_component: user account authentication
  behavior:
    source: user
    relationship: attempted to authenticate from
    target: port
  security_events:
  - event_id: 4625
    name: An account failed to log on.
    platform: Windows
    audit_category: Logon/Logoff
    audit_sub_category: Logon
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 4625
    name: An account failed to log on.
    platform: Windows
    audit_category: Logon/Logoff
    audit_sub_category: Account Lockout
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 4648
    name: A logon was attempted using explicit credentials.
    platform: Windows
    audit_category: Logon/Logoff
    audit_sub_category: Logon
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User attempted to authenticate to Application
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  attack:
    data_source: User Account
    data_component: user account authentication
  behavior:
    source: user
    relationship: attempted to authenticate to
    target: application
  security_events:
  - event_id: ConsoleLogin
    name: ConsoleLogin
    platform: AWS
    audit_category: AwsConsoleSignin
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  references:
  - https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-non-api-events.html
  notes: null
- name: User connected from Host
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: user
    relationship: connected from
    target: host
  security_events:
  - event_id: 3
    name: Network connection.
    platform: Windows
    audit_category: NetworkConnect
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: User connected from Ip
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: user
    relationship: connected from
    target: ip
  security_events:
  - event_id: 3
    name: Network connection.
    platform: Windows
    audit_category: NetworkConnect
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: User connected from Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: user
    relationship: connected from
    target: port
  security_events:
  - event_id: 3
    name: Network connection.
    platform: Windows
    audit_category: NetworkConnect
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: User connected to Host
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: user
    relationship: connected to
    target: host
  security_events:
  - event_id: 3
    name: Network connection.
    platform: Windows
    audit_category: NetworkConnect
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: User connected to Ip
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: user
    relationship: connected to
    target: ip
  security_events:
  - event_id: 3
    name: Network connection.
    platform: Windows
    audit_category: NetworkConnect
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: User connected to Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Traffic
    data_component: network connection creation
  behavior:
    source: user
    relationship: connected to
    target: port
  security_events:
  - event_id: 3
    name: Network connection.
    platform: Windows
    audit_category: NetworkConnect
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: User created AD Object
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Active Directory
    data_component: active directory object creation
  behavior:
    source: user
    relationship: created
    target: ad object
  security_events:
  - event_id: 5137
    name: A directory service object was created.
    platform: Windows
    audit_category: DS Access
    audit_sub_category: Directory Service Changes
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User created Instance
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  attack:
    data_source: Instance
    data_component: instance creation
  behavior:
    source: user
    relationship: created
    target: instance
  security_events:
  - event_id: RunInstances
    name: RunInstances
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  references: null
  notes: null
- name: User created Logon session
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Logon Session
    data_component: logon session creation
  behavior:
    source: user
    relationship: created
    target: logon session
  security_events:
  - event_id: 4624
    name: An account was successfully logged on.
    platform: Windows
    audit_category: Logon/Logoff
    audit_sub_category: Logon
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 4778
    name: A session was reconnected to a Window Station.
    platform: Windows
    audit_category: Logon/Logoff
    audit_sub_category: Other Logon/Logoff Events
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 4964
    name: Special groups have been assigned to a new logon.
    platform: Windows
    audit_category: Logon/Logoff
    audit_sub_category: Special Logon
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: DeviceLogonEvents
    name: DeviceLogonEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: User created logon session from Ip
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Logon Session
    data_component: logon session creation
  behavior:
    source: user
    relationship: created logon session from
    target: ip
  security_events:
  - event_id: 4624
    name: An account was successfully logged on.
    platform: Windows
    audit_category: Logon/Logoff
    audit_sub_category: Logon
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 4778
    name: A session was reconnected to a Window Station.
    platform: Windows
    audit_category: Logon/Logoff
    audit_sub_category: Other Logon/Logoff Events
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: DeviceLogonEvents
    name: DeviceLogonEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: User created logon session from Port
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Logon Session
    data_component: logon session creation
  behavior:
    source: user
    relationship: created logon session from
    target: port
  security_events:
  - event_id: 4624
    name: An account was successfully logged on.
    platform: Windows
    audit_category: Logon/Logoff
    audit_sub_category: Logon
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: DeviceLogonEvents
    name: DeviceLogonEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: User created Network Share
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Share
    data_component: network share creation
  behavior:
    source: user
    relationship: created
    target: network share
  security_events:
  - event_id: 5142
    name: A network share object was added.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: File Share
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User created Process
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Process
    data_component: process creation
  behavior:
    source: user
    relationship: created
    target: process
  security_events:
  - event_id: 4688
    name: A new process has been created.
    platform: Windows
    audit_category: Detailed Tracking
    audit_sub_category: Process Creation
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 1
    name: Process Creation.
    platform: Windows
    audit_category: ProcessCreate
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: DeviceProcessEvents
    name: DeviceProcessEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: User created Schedule job
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Schedule Job
    data_component: schedule job creation
  behavior:
    source: user
    relationship: created
    target: schedule job
  security_events:
  - event_id: 4698
    name: A scheduled task was created.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Other Object Access Events
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User created Service
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Service
    data_component: service creation
  behavior:
    source: user
    relationship: created
    target: service
  security_events:
  - event_id: 4697
    name: A service was installed in the system.
    platform: Windows
    audit_category: System
    audit_sub_category: Security System Extension
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 7045
    name: A new service was installed in the system.
    platform: Windows
    log_channel: System
    log_provider: Service Control Manager
  references: null
  notes: null
- name: User created User
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: User Account
    data_component: user account creation
  behavior:
    source: user
    relationship: created
    target: user
  security_events:
  - event_id: 4720
    name: A user account was created.
    platform: Windows
    audit_category: Account Management
    audit_sub_category: User Account Management
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User created Wmi object
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: WMI
    data_component: wmi creation
  behavior:
    source: user
    relationship: created
    target: wmi object
  security_events:
  - event_id: 19
    name: WmiEvent (WmiEventFilter activity detected).
    platform: Windows
    audit_category: WmiEvent
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 20
    name: WmiEvent (WmiEventConsumer activity detected).
    platform: Windows
    audit_category: WmiEvent
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 21
    name: WmiEvent (WmiEventConsumerToFilter activity detected).
    platform: Windows
    audit_category: WmiEvent
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: User deleted AD Object
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Active Directory
    data_component: active directory object deletion
  behavior:
    source: user
    relationship: deleted
    target: ad object
  security_events:
  - event_id: 5141
    name: A directory service object was deleted.
    platform: Windows
    audit_category: DS Access
    audit_sub_category: Directory Service Changes
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User deleted File
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: File
    data_component: file deletion
  behavior:
    source: user
    relationship: deleted
    target: file
  security_events:
  - event_id: 23
    name: File Delete archived.
    platform: Windows
    audit_category: FileDelete
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 26
    name: File Delete logged.
    platform: Windows
    audit_category: FileDeleteDetected
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 4660
    name: An object was deleted.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: File System
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User deleted Network share
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Share
    data_component: network share deletion
  behavior:
    source: user
    relationship: deleted
    target: network share
  security_events:
  - event_id: 5144
    name: A network share object was deleted.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: File Share
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User deleted Schedule job
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Schedule Job
    data_component: schedule job deletion
  behavior:
    source: user
    relationship: deleted
    target: schedule job
  security_events:
  - event_id: 4699
    name: A scheduled task was deleted.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Other Object Access Events
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User deleted User
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: User Account
    data_component: user account deletion
  behavior:
    source: user
    relationship: deleted
    target: user
  security_events:
  - event_id: 4726
    name: A user account was deleted.
    platform: Windows
    audit_category: Account Management
    audit_sub_category: User Account Management
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User deleted Windows registry key
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Windows Registry
    data_component: windows registry key deletion
  behavior:
    source: user
    relationship: deleted
    target: windows registry key
  security_events:
  - event_id: 4660
    name: An object was deleted.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Registry
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User deleted Wmi object
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: WMI
    data_component: wmi deletion
  behavior:
    source: user
    relationship: deleted
    target: wmi object
  security_events:
  - event_id: 19
    name: WmiEvent (WmiEventFilter activity detected).
    platform: Windows
    audit_category: WmiEvent
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 20
    name: WmiEvent (WmiEventConsumer activity detected).
    platform: Windows
    audit_category: WmiEvent
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 21
    name: WmiEvent (WmiEventConsumerToFilter activity detected).
    platform: Windows
    audit_category: WmiEvent
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  references: null
  notes: null
- name: User disabled Schedule job
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Schedule Job
    data_component: schedule job modification
  behavior:
    source: user
    relationship: disabled
    target: schedule job
  security_events:
  - event_id: 4701
    name: A scheduled task was disabled.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Other Object Access Events
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User disabled User
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: User Account
    data_component: user account modification
  behavior:
    source: user
    relationship: disabled
    target: user
  security_events:
  - event_id: 4725
    name: A user account was disabled.
    platform: Windows
    audit_category: Account Management
    audit_sub_category: User Account Management
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User enabled Schedule job
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Schedule job
    data_component: schedule job modification
  behavior:
    source: user
    relationship: enabled
    target: schedule job
  security_events:
  - event_id: 4700
    name: A scheduled task was enabled.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Other Object Access Events
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User enabled User
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: User Account
    data_component: user account modification
  behavior:
    source: user
    relationship: enabled
    target: user
  security_events:
  - event_id: 4722
    name: A user account was enabled.
    platform: Windows
    audit_category: Account Management
    audit_sub_category: User Account Management
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User executed Command
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Command
    data_component: command execution
  behavior:
    source: user
    relationship: executed
    target: command
  security_events:
  - event_id: 4688
    name: A new process has been created.
    platform: Windows
    audit_category: Detailed Tracking
    audit_sub_category: Process Creation
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 1
    name: Process Creation.
    platform: Windows
    audit_category: ProcessCreate
    log_channel: Microsoft-Windows-Sysmon/Operational
    log_provider: Microsoft-Windows-Sysmon
  - event_id: 4103
    name: Module logging.
    platform: Windows
    audit_category: Executing Pipeline
    log_channel: Microsoft-Windows-PowerShell/Operational
    log_provider: Microsoft-Windows-PowerShell
  - event_id: DeviceProcessEvents
    name: DeviceProcessEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: User granted acess to User
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: User Account
    data_component: user account modification
  behavior:
    source: user
    relationship: granted access to
    target: user
  security_events:
  - event_id: 4717
    name: System security access was granted to an account.
    platform: Windows
    audit_category: Policy Change
    audit_sub_category: Authentication Policy Change
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User listed Firewall rule
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  attack:
    data_source: Firewall
    data_component: firewall enumeration
  behavior:
    source: user
    relationship: listed
    target: firewall rule
  security_events:
  - event_id: ListRuleGroups
    name: ListRuleGroups
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  references: null
  notes: null
- name: User locked User
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: User Account
    data_component: user account modification
  behavior:
    source: user
    relationship: locked
    target: user
  security_events:
  - event_id: 4740
    name: A user account was locked out.
    platform: Windows
    audit_category: Account Management
    audit_sub_category: User Account Management
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User modified AD Object
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Active Directory
    data_component: active directory object modification
  behavior:
    source: user
    relationship: modified
    target: ad object
  security_events:
  - event_id: 5136
    name: A directory service object was modified.
    platform: Windows
    audit_category: DS Access
    audit_sub_category: Directory Service Changes
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 5139
    name: A directory service object was moved.
    platform: Windows
    audit_category: DS Access
    audit_sub_category: Directory Service Changes
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User modified Cloud service
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  attack:
    data_source: Cloud Service
    data_component: cloud service modification
  behavior:
    source: user
    relationship: modified
    target: cloud service
  security_events:
  - event_id: UpdateTrail
    name: UpdateTrail
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  references: null
  notes: null
- name: User modified File
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: File
    data_component: file modification
  behavior:
    source: user
    relationship: modified
    target: file
  security_events:
  - event_id: 4670
    name: Permissions on an object were changed.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: File System
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: DeviceFileEvents
    name: DeviceFileEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: User modified Firewall rule
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  attack:
    data_source: Firewall
    data_component: firewall rule modification
  behavior:
    source: user
    relationship: modified
    target: firewall rule
  security_events:
  - event_id: 2005
    name: A rule has been modified in the Windows Defender Firewall exception list.
    platform: Windows
    audit_category: null
    audit_sub_category: null
    log_channel: Microsoft-Windows-Windows Firewall With Advanced Security/Firewall
    log_provider: Microsoft-Windows-Windows Firewall With Advanced Security
  - event_id: UpdateRuleGroup
    name: UpdateRuleGroup
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  references: null
  notes: null
- name: User modified Instance
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  attack:
    data_source: Instance
    data_component: instance modification
  behavior:
    source: user
    relationship: modified
    target: instance
  security_events:
  - event_id: ModifyInstanceAttribute
    name: ModifyInstanceAttribute
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  references: null
  notes: null
- name: User modified Network share
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Network Share
    data_component: network share modification
  behavior:
    source: user
    relationship: modified
    target: network share
  security_events:
  - event_id: 5143
    name: A network share object was modified.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: File Share
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User modified Schedule job
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Schedule Job
    data_component: schedule job modification
  behavior:
    source: user
    relationship: modified
    target: schedule job
  security_events:
  - event_id: 4702
    name: A scheduled task was updated.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Other Object Access Events
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User modified User
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: User Account
    data_component: user account modification
  behavior:
    source: user
    relationship: modified
    target: user
  security_events:
  - event_id: 4738
    name: A user account was changed.
    platform: Windows
    audit_category: Account Management
    audit_sub_category: User Account Management
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 4781
    name: The name of an account was changed.
    platform: Windows
    audit_category: Account Management
    audit_sub_category: User Account Management
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User modified Windows registry key
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Windows Registry
    data_component: windows registry key modification
  behavior:
    source: user
    relationship: modified
    target: windows registry key
  security_events:
  - event_id: 4670
    name: Permissions on an object were changed.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Registry
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: DeviceRegistryEvents
    name: DeviceRegistryEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: User modified Windows registry key value
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Windows Registry
    data_component: windows registry key modification
  behavior:
    source: user
    relationship: modified
    target: windows registry key value
  security_events:
  - event_id: 4657
    name: A registry value was modified.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Registry
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: DeviceRegistryEvents
    name: DeviceRegistryEvents
    platform: Windows
    audit_category: null
    log_channel: null
    log_provider: Windows Defender Advanced Threat Protection
  references: null
  notes: null
- name: User removed acess from User
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: User Account
    data_component: user account modification
  behavior:
    source: user
    relationship: removed access from
    target: user
  security_events:
  - event_id: 4718
    name: System security access was removed from an account.
    platform: Windows
    audit_category: Policy Change
    audit_sub_category: Authentication Policy Change
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User removed Firewall rule
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  attack:
    data_source: Firewall
    data_component: firewall rule modification
  behavior:
    source: user
    relationship: removed
    target: firewall rule
  security_events:
  - event_id: 2006
    name: A rule has been deleted in the Windows Defender Firewall exception list
    platform: Windows
    audit_category: null
    audit_sub_category: null
    log_channel: Microsoft-Windows-Windows Firewall With Advanced Security/Firewall
    log_provider: Microsoft-Windows-Windows Firewall With Advanced Security
  - event_id: DeleteRuleGroup
    name: DeleteRuleGroup
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  references: null
  notes: null
- name: User requested access to AD Object
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Active Directory
    data_component: active directory object access
  behavior:
    source: user
    relationship: requested access to
    target: ad object
  security_events:
  - event_id: 4661
    name: A handle to an object was requested.
    platform: Windows
    audit_category: DS Access
    audit_sub_category: Directory Service Access
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User requested access to File
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: File
    data_component: file access
  behavior:
    source: user
    relationship: requested access to
    target: file
  security_events:
  - event_id: 4656
    name: A handle to an object was requested.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: File System
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  - event_id: 4661
    name: A handle to an object was requested.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: SAM
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User requested access to Service
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Service
    data_component: service access
  behavior:
    source: user
    relationship: requested access to
    target: service
  security_events:
  - event_id: 4656
    name: A handle to an object was requested.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Other Object Access Events
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User requested access to Windows registry key
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Windows Registry
    data_component: windows registry key access
  behavior:
    source: user
    relationship: requested access to
    target: windows registry key
  security_events:
  - event_id: 4656
    name: A handle to an object was requested.
    platform: Windows
    audit_category: Object Access
    audit_sub_category: Registry
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  note: null
- name: User retrieved information about Cloud service
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  attack:
    data_source: Cloud Service
    data_component: cloud service metadata
  behavior:
    source: user
    relationship: retrieved information about
    target: cloud service
  security_events:
  - event_id: GetTrail
    name: GetTrail
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  - event_id: GetTrailStatus
    name: GetTrailStatus
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  - event_id: DescribeTrails
    name: DescribeTrails
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  - event_id: GetEventSelectors
    name: GetEventSelectors
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  - event_id: GetInsightSelectors
    name: GetInsightSelectors
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  references: null
  notes: null
- name: User retrieved information about cloud service from Ip
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  attack:
    data_source: Cloud Service
    data_component: cloud service metadata
  behavior:
    source: user
    relationship: retrieved information about cloud service from
    target: ip
  security_events:
  - event_id: GetTrail
    name: GetTrail
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  - event_id: GetTrailStatus
    name: GetTrailStatus
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  - event_id: DescribeTrails
    name: DescribeTrails
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  - event_id: GetEventSelectors
    name: GetEventSelectors
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  - event_id: GetInsightSelectors
    name: GetInsightSelectors
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  references: null
  notes:
  - Potential contribution for ATT&CK - Cloud Service / cloud service metadata
- name: User retrieved information about Firewall
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  attack:
    data_source: Firewall
    data_component: firewall metadata
  behavior:
    source: user
    relationship: retrieved information about
    target: firewall
  security_events:
  - event_id: DescribeFirewall
    name: DescribeFirewall
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  - event_id: DescribeFirewallPolicy
    name: DescribeFirewallPolicy
    platform: AWS
    audit_category: AwsApiCall
    audit_sub_category: null
    log_channel: null
    log_provider: CloudTrail
  references: null
  notes: null
- name: User terminated Logon session
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Logon Session
    data_component: logon session termination
  behavior:
    source: user
    relationship: terminated
    target: logon session
  security_events:
  - event_id: 4634
    name: An account was logged off.
    platform: Windows
    audit_category: Logon/Logoff
    audit_sub_category: Logoff
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User terminated Process
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: Process
    data_component: process termination
  behavior:
    source: user
    relationship: terminated
    target: process
  security_events:
  - event_id: 4689
    name: A process has exited.
    platform: Windows
    audit_category: Detailed Tracking
    audit_sub_category: Process Termination
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
- name: User unlocked User
  contributors:
  - Jose Rodriguez @Cyb3rPandaH
  - Roberto Rodriguez @Cyb3rWard0g
  attack:
    data_source: User Account
    data_component: user account modification
  behavior:
    source: user
    relationship: unlocked
    target: user
  security_events:
  - event_id: 4767
    name: A user account was unlocked.
    platform: Windows
    audit_category: Account Management
    audit_sub_category: User Account Management
    log_channel: Security
    log_provider: Microsoft-Windows-Security-Auditing
  references: null
  notes: null
